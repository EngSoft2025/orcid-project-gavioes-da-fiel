{"ast":null,"code":"import React,{useEffect,useRef,useState}from\"react\";import Chart from\"chart.js/auto\";// A simple skeleton loader for the chart\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChartSkeleton=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"chart-skeleton-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-bar\",style:{height:'60%'}}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-bar\",style:{height:'80%'}}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-bar\",style:{height:'70%'}}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-bar\",style:{height:'90%'}}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-bar\",style:{height:'75%'}}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton-bar\",style:{height:'85%'}})]});function ChartsSection(_ref){let{orcidId}=_ref;const chartRef=useRef(null);const chartInstance=useRef(null);const[chartData,setChartData]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{if(!orcidId){setLoading(false);return;}async function fetchStats(){setLoading(true);setError(null);try{const res=await fetch(\"http://localhost:8000/orcid/\".concat(orcidId,\"/stats\"));if(!res.ok)throw new Error(\"Erro ao buscar estatísticas do gráfico.\");const json=await res.json();setChartData(json);}catch(err){setError(err.message);console.error(\"Erro ao carregar dados do gráfico:\",err);}finally{setLoading(false);}}fetchStats();},[orcidId]);useEffect(()=>{if(!chartData||loading||error){if(chartInstance.current){chartInstance.current.destroy();chartInstance.current=null;}return;}const{years,publications,citations}=chartData;if(chartInstance.current){chartInstance.current.destroy();}const ctx=chartRef.current.getContext(\"2d\");chartInstance.current=new Chart(ctx,{type:\"bar\",data:{labels:years,datasets:[{label:\"Citações\",data:citations,type:\"line\",fill:false,borderColor:\"rgba(255, 99, 132, 1)\",backgroundColor:\"rgba(255, 99, 132, 0.5)\",yAxisID:\"yCitations\",tension:0.1,order:0},{label:\"Publicações\",data:publications,backgroundColor:\"rgba(54, 162, 235, 0.8)\",borderColor:\"rgba(54, 162, 235, 1)\",yAxisID:\"yPublications\",order:1}]},options:{responsive:true,maintainAspectRatio:false,interaction:{mode:\"index\",intersect:false},scales:{x:{title:{display:true,text:'Ano'}},yCitations:{type:'linear',display:true,position:'left',title:{display:true,text:'Citações',color:'rgba(255, 99, 132, 1)'},ticks:{color:'rgba(255, 99, 132, 1)'},grid:{drawOnChartArea:true}},yPublications:{type:'linear',display:true,position:'right',title:{display:true,text:'Publicações',color:'rgba(54, 162, 235, 1)'},ticks:{color:'rgba(54, 162, 235, 1)',stepSize:5},grid:{drawOnChartArea:false}}},plugins:{legend:{position:'top'},tooltip:{callbacks:{label:function(context){return\"\".concat(context.dataset.label||\"\",\": \").concat(context.parsed.y);}}}}}});return()=>{if(chartInstance.current){chartInstance.current.destroy();chartInstance.current=null;}};},[chartData,loading,error]);if(loading)return/*#__PURE__*/_jsx(ChartSkeleton,{});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"error-message chart-error\",children:\"Erro ao carregar o gr\\xE1fico.\"});if(!chartData||!chartData.years||chartData.years.length===0)return/*#__PURE__*/_jsx(\"div\",{className:\"empty-state chart-empty\",children:\"Nenhum dado dispon\\xEDvel.\"});return/*#__PURE__*/_jsx(\"div\",{className:\"chart-canvas-container\",style:{height:'450px',width:'100%'},children:/*#__PURE__*/_jsx(\"canvas\",{ref:chartRef})});}export default ChartsSection;","map":{"version":3,"names":["React","useEffect","useRef","useState","Chart","jsx","_jsx","jsxs","_jsxs","ChartSkeleton","className","children","style","height","ChartsSection","_ref","orcidId","chartRef","chartInstance","chartData","setChartData","loading","setLoading","error","setError","fetchStats","res","fetch","concat","ok","Error","json","err","message","console","current","destroy","years","publications","citations","ctx","getContext","type","data","labels","datasets","label","fill","borderColor","backgroundColor","yAxisID","tension","order","options","responsive","maintainAspectRatio","interaction","mode","intersect","scales","x","title","display","text","yCitations","position","color","ticks","grid","drawOnChartArea","yPublications","stepSize","plugins","legend","tooltip","callbacks","context","dataset","parsed","y","length","width","ref"],"sources":["C:/Users/beatr/OneDrive/Documentos/engsoft/orcid-project-gavioes-da-fiel/frontend/src/components/ChartsSection.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport Chart from \"chart.js/auto\";\r\n\r\n// A simple skeleton loader for the chart\r\nconst ChartSkeleton = () => (\r\n  <div className=\"chart-skeleton-container\">\r\n    <div className=\"skeleton-bar\" style={{ height: '60%' }}></div>\r\n    <div className=\"skeleton-bar\" style={{ height: '80%' }}></div>\r\n    <div className=\"skeleton-bar\" style={{ height: '70%' }}></div>\r\n    <div className=\"skeleton-bar\" style={{ height: '90%' }}></div>\r\n    <div className=\"skeleton-bar\" style={{ height: '75%' }}></div>\r\n    <div className=\"skeleton-bar\" style={{ height: '85%' }}></div>\r\n  </div>\r\n);\r\n\r\nfunction ChartsSection({ orcidId }) {\r\n  const chartRef = useRef(null);\r\n  const chartInstance = useRef(null);\r\n  const [chartData, setChartData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (!orcidId) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    async function fetchStats() {\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        const res = await fetch(`http://localhost:8000/orcid/${orcidId}/stats`);\r\n        if (!res.ok) throw new Error(\"Erro ao buscar estatísticas do gráfico.\");\r\n        const json = await res.json();\r\n        setChartData(json);\r\n      } catch (err) {\r\n        setError(err.message);\r\n        console.error(\"Erro ao carregar dados do gráfico:\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    fetchStats();\r\n  }, [orcidId]);\r\n\r\n  useEffect(() => {\r\n    if (!chartData || loading || error) {\r\n      if (chartInstance.current) {\r\n        chartInstance.current.destroy();\r\n        chartInstance.current = null;\r\n      }\r\n      return;\r\n    }\r\n\r\n    const { years, publications, citations } = chartData;\r\n\r\n    if (chartInstance.current) {\r\n      chartInstance.current.destroy();\r\n    }\r\n\r\n    const ctx = chartRef.current.getContext(\"2d\");\r\n    chartInstance.current = new Chart(ctx, {\r\n      type: \"bar\",\r\n      data: {\r\n        labels: years,\r\n        datasets: [\r\n          {\r\n            label: \"Citações\",\r\n            data: citations,\r\n            type: \"line\",\r\n            fill: false,\r\n            borderColor: \"rgba(255, 99, 132, 1)\",\r\n            backgroundColor: \"rgba(255, 99, 132, 0.5)\",\r\n            yAxisID: \"yCitations\",\r\n            tension: 0.1,\r\n            order: 0,\r\n          },\r\n          {\r\n            label: \"Publicações\",\r\n            data: publications,\r\n            backgroundColor: \"rgba(54, 162, 235, 0.8)\",\r\n            borderColor: \"rgba(54, 162, 235, 1)\",\r\n            yAxisID: \"yPublications\",\r\n            order: 1,\r\n          },\r\n        ],\r\n      },\r\n      options: {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        interaction: { mode: \"index\", intersect: false },\r\n        scales: {\r\n          x: { title: { display: true, text: 'Ano' } },\r\n          yCitations: {\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'left',\r\n            title: { display: true, text: 'Citações', color: 'rgba(255, 99, 132, 1)' },\r\n            ticks: { color: 'rgba(255, 99, 132, 1)' },\r\n            grid: { drawOnChartArea: true },\r\n          },\r\n          yPublications: {\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            title: { display: true, text: 'Publicações', color: 'rgba(54, 162, 235, 1)' },\r\n            ticks: { color: 'rgba(54, 162, 235, 1)', stepSize: 5 },\r\n            grid: { drawOnChartArea: false },\r\n          },\r\n        },\r\n        plugins: {\r\n          legend: { position: 'top' },\r\n          tooltip: {\r\n            callbacks: {\r\n              label: function (context) {\r\n                return `${context.dataset.label || \"\"}: ${context.parsed.y}`;\r\n              },\r\n            },\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    return () => {\r\n      if (chartInstance.current) {\r\n        chartInstance.current.destroy();\r\n        chartInstance.current = null;\r\n      }\r\n    };\r\n  }, [chartData, loading, error]);\r\n\r\n  if (loading) return <ChartSkeleton />;\r\n  if (error) return <div className=\"error-message chart-error\">Erro ao carregar o gráfico.</div>;\r\n  if (!chartData || !chartData.years || chartData.years.length === 0) return <div className=\"empty-state chart-empty\">Nenhum dado disponível.</div>;\r\n\r\n  return (\r\n    <div className=\"chart-canvas-container\" style={{ height: '450px', width: '100%' }}>\r\n      <canvas ref={chartRef}></canvas>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChartsSection;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}