{"ast":null,"code":"import React,{useState,useEffect}from'react';// A simple helper component for the loading state\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MetricItemSkeleton=()=>/*#__PURE__*/_jsxs(\"li\",{className:\"skeleton-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"skeleton-text short\"}),/*#__PURE__*/_jsx(\"span\",{className:\"skeleton-text long\"})]});function AggregatedMetrics(_ref){var _metrics$pesquisa_mai;let{orcidId}=_ref;const[metrics,setMetrics]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{if(!orcidId){setLoading(false);return;};async function fetchMetrics(){setLoading(true);setError(null);try{const res=await fetch(\"http://localhost:8000/orcid/\".concat(orcidId,\"/metrics\"));if(!res.ok)throw new Error(\"Failed to fetch metrics with status \".concat(res.status));const data=await res.json();setMetrics(data);}catch(err){setError(err.message);console.error(\"Error fetching aggregated metrics:\",err);}finally{setLoading(false);}}fetchMetrics();},[orcidId]);// Helper to format numbers with dots for thousands separators\nconst formatNumber=num=>{if(typeof num!=='number')return num;return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\".\");};// Helper to format floats with a comma for the decimal point\nconst formatFloat=num=>{if(typeof num!=='number')return num;// Round to 1 decimal place and then replace the dot\nreturn num.toFixed(1).toString().replace('.',',');};return/*#__PURE__*/_jsxs(\"div\",{className:\"aggregated-metrics-card\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"section-title\",children:\"M\\xE9tricas Agregadas\"}),loading&&/*#__PURE__*/_jsx(\"ul\",{className:\"metrics-list\",children:Array.from({length:7}).map((_,i)=>/*#__PURE__*/_jsx(MetricItemSkeleton,{},i))}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:\"Erro ao carregar m\\xE9tricas.\"}),!loading&&!error&&metrics&&/*#__PURE__*/_jsxs(\"ul\",{className:\"metrics-list\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total de Publica\\xE7\\xF5es:\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatNumber(metrics.total_publicacoes)})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total de Cita\\xE7\\xF5es:\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatNumber(metrics.total_citacoes)})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"M\\xE9dia de Cita\\xE7\\xF5es:\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatFloat(metrics.media_citacoes)})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Fator de Impacto (2 anos):\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatFloat(metrics.fator_de_impacto)})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\xCDndice H:\"}),/*#__PURE__*/_jsx(\"strong\",{children:metrics.h_index})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\xCDndice i10:\"}),/*#__PURE__*/_jsx(\"strong\",{children:metrics.i10_index})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Cita\\xE7\\xF5es da Pesquisa Mais Citada:\"}),/*#__PURE__*/_jsx(\"strong\",{children:formatNumber((_metrics$pesquisa_mai=metrics.pesquisa_mais_citada)===null||_metrics$pesquisa_mai===void 0?void 0:_metrics$pesquisa_mai.citations)})]})]})]});}export default AggregatedMetrics;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","MetricItemSkeleton","className","children","AggregatedMetrics","_ref","_metrics$pesquisa_mai","orcidId","metrics","setMetrics","loading","setLoading","error","setError","fetchMetrics","res","fetch","concat","ok","Error","status","data","json","err","message","console","formatNumber","num","toString","replace","formatFloat","toFixed","Array","from","length","map","_","i","total_publicacoes","total_citacoes","media_citacoes","fator_de_impacto","h_index","i10_index","pesquisa_mais_citada","citations"],"sources":["C:/Users/beatr/OneDrive/Documentos/engsoft/orcid-project-gavioes-da-fiel/frontend/src/components/AggregatedMetrics.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n\r\n// A simple helper component for the loading state\r\nconst MetricItemSkeleton = () => (\r\n  <li className=\"skeleton-item\">\r\n    <span className=\"skeleton-text short\"></span>\r\n    <span className=\"skeleton-text long\"></span>\r\n  </li>\r\n);\r\n\r\nfunction AggregatedMetrics({ orcidId }) {\r\n  const [metrics, setMetrics] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (!orcidId) {\r\n        setLoading(false);\r\n        return;\r\n    };\r\n\r\n    async function fetchMetrics() {\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        const res = await fetch(`http://localhost:8000/orcid/${orcidId}/metrics`);\r\n        if (!res.ok) throw new Error(`Failed to fetch metrics with status ${res.status}`);\r\n        const data = await res.json();\r\n        setMetrics(data);\r\n      } catch (err) {\r\n        setError(err.message);\r\n        console.error(\"Error fetching aggregated metrics:\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    fetchMetrics();\r\n  }, [orcidId]);\r\n\r\n  // Helper to format numbers with dots for thousands separators\r\n  const formatNumber = (num) => {\r\n    if (typeof num !== 'number') return num;\r\n    return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\r\n  }\r\n  \r\n  // Helper to format floats with a comma for the decimal point\r\n  const formatFloat = (num) => {\r\n    if (typeof num !== 'number') return num;\r\n    // Round to 1 decimal place and then replace the dot\r\n    return num.toFixed(1).toString().replace('.', ',');\r\n  }\r\n\r\n  return (\r\n    <div className=\"aggregated-metrics-card\">\r\n      <h3 className=\"section-title\">Métricas Agregadas</h3>\r\n      {loading && (\r\n        <ul className=\"metrics-list\">\r\n          {Array.from({ length: 7 }).map((_, i) => <MetricItemSkeleton key={i} />)}\r\n        </ul>\r\n      )}\r\n      {error && <div className=\"error-message\">Erro ao carregar métricas.</div>}\r\n      {!loading && !error && metrics && (\r\n        <ul className=\"metrics-list\">\r\n          <li>\r\n            <span>Total de Publicações:</span>\r\n            <strong>{formatNumber(metrics.total_publicacoes)}</strong>\r\n          </li>\r\n          <li>\r\n            <span>Total de Citações:</span>\r\n            <strong>{formatNumber(metrics.total_citacoes)}</strong>\r\n          </li>\r\n          <li>\r\n            <span>Média de Citações:</span>\r\n            <strong>{formatFloat(metrics.media_citacoes)}</strong>\r\n          </li>\r\n          <li>\r\n            <span>Fator de Impacto (2 anos):</span>\r\n            <strong>{formatFloat(metrics.fator_de_impacto)}</strong>\r\n          </li>\r\n          <li>\r\n            <span>Índice H:</span>\r\n            <strong>{metrics.h_index}</strong>\r\n          </li>\r\n          <li>\r\n            <span>Índice i10:</span>\r\n            <strong>{metrics.i10_index}</strong>\r\n          </li>\r\n          <li>\r\n            <span>Citações da Pesquisa Mais Citada:</span>\r\n            <strong>{formatNumber(metrics.pesquisa_mais_citada?.citations)}</strong>\r\n          </li>\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AggregatedMetrics;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}